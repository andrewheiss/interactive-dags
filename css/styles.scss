/*-- scss:defaults --*/

/*-- scss:rules --*/

// Bootstrap hardcodes dark text on .btn-secondary and .btn-light regardless of
// the actual background color. This reapplies Bootstrap's precalculated dark
// button text color to be used with my dark secondary color (steel: "#5d6174")
.btn-secondary,
.btn-outline-secondary {
  color: var(--bs-btn-color);
}

// Better hover contrast for .btn-primary - shift to mustard instead of slightly
// darker rust, which is hardly visible
.btn-primary {
  &:hover,
  &:active,
  &:focus-visible {
    background-color: $brand-mustard;
    border-color: $brand-mustard;
  }
}

body.home {
  h2 {
    text-align: center;

    // The little anchored link icon messes with the centered alignment; 
    // this makes the icon not get included in the heading text block
    &.anchored {
      .anchorjs-link {
        display: inline-block;
        position: absolute;
      }
    }
  }

  .epigraph {
    blockquote {
      border-left: 0;
      padding-left: 0;
      padding-right: 0;
    }
  }
}

// -----------------------------------------------------------------------------
// Simulation styles

// Hide the number input box from sliders
form:has(input[type="range"]) input[type="number"] {
  display: none;
}

// Make it so checkbox labels take the full width instead of being constrained
// to whatever --label-width is set to; this also makes it so the checkbox
// itself is right-aligned
form:has(input[type="checkbox"]) {
  label {
    width: auto !important;
    flex: 1;
  }

  input[type="checkbox"] {
    margin-bottom: 0;
    margin-right: 0;
  }
}

// Hide the code-copy button when the code itself is hidden (OJS inputs like
// to include the copy button??)
.code-copy-outer-scaffold:has(.cell-code.hidden) .code-copy-button {
  display: none;
}

.interactive {
  h6 {
    margin: 1.5rem 0 0;
    font-weight: normal;
    font-size: 0.9em;
    text-align: left;
    color: $brand-slate;
  }

  section:first-of-type h6 {
    margin-top: 0;
  }
}

// Box explaining general status
.status-readout {
  margin-top: 1.5em;
  font-size: 0.95em;

  p:last-child,
  table:last-child {
    margin-bottom: 0;
  }

  table {
    border: none;
    width: auto;
    background: none !important;
  }

  td {
    border: none;
    padding: 0.15em 0.5em;
    vertical-align: middle;
  }

  // Swatch column
  td:first-child {
    padding-left: 0;
    padding-right: 0.3em;
  }

  // Percentage column
  td:last-child {
    text-align: right;
    font-variant-numeric: tabular-nums;
  }

  // Summary row with top border
  tr.summary td {
    border-top: 1px solid rgba(0, 0, 0, 0.15);
    padding-top: 0.4em;
  }

  // Dimmed row
  tr.dimmed {
    opacity: 0.35;
  }
}

// Helper classes for highlighting node names (i.e. class="node node-x")
.node {
  font-weight: bold;

  &-x {
    color: $brand-rust;
  }

  &-y {
    color: $brand-darkblue;
  }

  &-z {
    color: $brand-mustard;
  }
}

// -----------------------------------------------------------------------------
// Other styles

// DAG dinkus! Little SVG icon of a three-node DAG
hr.dinkus {
  border: none;
  height: 26px;
  width: 32px;
  margin: 2em auto;
  background-color: #454545;
  mask: url("img/confounder-xy.svg") no-repeat center / contain;
  -webkit-mask: url("img/confounder-xy.svg") no-repeat center / contain;
}

// Modify the colors of the SVG DAG icons
img.dag-white {
  // invert(1) switches the black SVG to white
  // Use something like https://codepen.io/sosuke/pen/Pjoqqp to create
  // filters for other colors hex colors
  filter: invert(1);
  opacity: 0.85;
}

img.dag-footer {
  // This filter is #616161 via https://codepen.io/sosuke/pen/Pjoqqp
  filter: invert(37%) sepia(0%) saturate(0%) hue-rotate(290deg) brightness(100%) contrast(92%);
}

img.dag-steel {
  filter: invert(36%) sepia(14%) saturate(562%) hue-rotate(192deg) brightness(98%) contrast(85%);
}

// Shrink KaTeX math a little so it fits in the text better
.math.inline .katex {
  font-size: 1em !important;
}

// Special divs
.theorem.definition,
.theorem.lemma {
  @extend .alert;
  @extend .alert-info;
}

.general-note {
  @extend .alert;
  @extend .alert-danger;

  p:last-child {
    margin-bottom: 0;
  }
}

// -----------------------------------------------------------------------------
// Hero stuff

// Remove top spacing so hero sits flush against navbar
body:has(.hero-banner, .hero-banner-mini) #quarto-content main.content {
  padding-top: 0;
  margin-top: 0;

  #title-block-header {
    margin: 0;
    padding: 0;
    display: none;
  }
}

// Hero image section (standalone image, not the banner)
.hero-image {
  margin: 0;
  padding: 0;
  line-height: 0;

  p {
    margin: 0;
    padding: 0;
    line-height: 0;
  }

  img {
    width: 100%;
    height: 20vh;
    object-fit: cover;
    display: block;
  }
}

// Banner with page title
.hero-banner {
  position: relative;
  background: linear-gradient(to bottom, $brand-rust, $brand-burgundy);
  color: #ffffff;
  text-align: center;
  padding: 3rem 1rem;

  &::before {
    content: "";
    position: absolute;
    inset: 0;
    background: url("img/banner-transparent.svg") center / cover;
    mask-image: linear-gradient(to bottom, transparent 5%, #000000 35%);
    -webkit-mask-image: linear-gradient(to bottom, transparent 5%, #000000 35%);
    pointer-events: none;
  }

  h1 {
    position: relative;
    font-weight: 700;
    font-size: 2em;
    margin-bottom: 1em;
    color: #ffffff;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    text-shadow: 0 0 10px rgba(0, 0, 0, 1);
  }

  p {
    font-size: 1.7em;
    line-height: 1.3;
    color: $brand-silver;
  }

  &.main-title {
    h1 {
      font-size: 2.8em;
    }

    .banner-subtitle p {
      position: relative;
      color: #ffffff;
      box-shadow: 0 0 10px #000;
      background-color: $brand-burgundy;
      border-radius: 0.25rem;
      padding: 0.25em;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
  }

  &-mini {
    @extend .hero-banner;
    padding: 1rem 1rem;
    margin-bottom: 3rem;

    .banner-description p {
      position: relative;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(0, 0, 0, 1);
      font-size: 1.4em;
      padding: 0.25em;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
  }
}

// Footer stuff

.nav-footer {
  a:hover {
    color: $link-hover-color;
  }
}

// Footer center section stuff
.nav-footer .nav-footer-center {

  // Override Quarto's large margin-top on narrow screens
  @media (max-width: 767.98px) {
    margin-top: 0;
  }

  p {
    margin-bottom: 0.5em;
  }

  .toc-actions {
    padding: 0;

    // Center the GitHub actions links
    ul {
      padding-left: 0;
      margin-bottom: 0;
      justify-content: center;
      gap: 0.25em;

      li {
        margin: 0;
        padding: 0;
      }
    }
  }
}

.home-cards {
  // Responsive DAG thumbnail size: smaller when cards are full-width (xs),
  // larger when they're in a 3-column grid (sm+)
  img.card-dag {
    width: 28%;

    @include media-breakpoint-up(sm) {
      width: 50%;
    }
  }
}
