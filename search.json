[
  {
    "objectID": "mediators.html",
    "href": "mediators.html",
    "title": "Mediators",
    "section": "",
    "text": "d3 = require(\"d3@7\")\ndag = import(new URL(\"js/dag-utils.js\", document.baseURI).href)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelationships between nodes\n\nviewof strength_xz = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; strength`\n})\n\nviewof strength_zy = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; strength`\n})\n\nviewof strength_xy = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; strength`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAdjustments\n\nviewof adjust_z = Inputs.toggle({\n  label: html`&lt;span class=\"node node-z\"&gt;Adjust for Z&lt;/span&gt; (&lt;em&gt;block indirect path&lt;/em&gt;)`\n})\n\n\n\n\n\n\n\n// ----------------\n// Status readout\n// ----------------\n{\n  const pctDirect = Math.round(y_direct_x / yMax * 100);\n  const pctMediated = Math.round(y_mediated / yMax * 100);\n  const pctZ = Math.round(y_from_z_own / yMax * 100);\n  const pctOwn = Math.max(0, 100 - pctDirect - pctMediated - pctZ);\n\n  return html`&lt;div class=\"alert alert-secondary status-readout\"&gt;\n    &lt;h5 class=\"alert-heading\"&gt;What Y contains&lt;/h5&gt;\n    &lt;table&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-x\"&gt;X&lt;/span&gt;'s direct influence on &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctDirect}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;\n          &lt;defs&gt;\n            &lt;pattern id=\"legend-hatch-med\" patternUnits=\"userSpaceOnUse\"\n              width=\"6\" height=\"6\" patternTransform=\"rotate(-45)\"&gt;\n              &lt;rect width=\"6\" height=\"6\" fill=\"${dag.colorX}\"/&gt;\n              &lt;line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"6\"\n                stroke=\"${dag.colorZ}\" stroke-width=\"2.5\"/&gt;\n            &lt;/pattern&gt;\n          &lt;/defs&gt;\n          &lt;rect width=\"12\" height=\"12\" fill=\"url(#legend-hatch-med)\"/&gt;\n        &lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-x\"&gt;X&lt;/span&gt;'s influence on &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; via &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctMediated}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorZ}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;'s own variation flowing to &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctZ}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorY}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;'s own variation&lt;/td&gt;\n        &lt;td&gt;${pctOwn}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"summary ${adjust_z ? 'dimmed' : ''}\"&gt;\n        &lt;td&gt;\n          &lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;\n          +\n          &lt;svg width=\"12\" height=\"12\"&gt;\n            &lt;rect width=\"12\" height=\"12\" fill=\"url(#legend-hatch-med)\"/&gt;\n          &lt;/svg&gt;\n        &lt;/td&gt;\n        &lt;td&gt;Total &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; effect&lt;/td&gt;\n        &lt;td&gt;${pctDirect + pctMediated}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"summary ${adjust_z ? '' : 'dimmed'}\"&gt;\n        &lt;td&gt;\n          &lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;\n        &lt;/td&gt;\n        &lt;td&gt;Direct-only &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; effect&lt;/td&gt;\n        &lt;td&gt;${pctDirect}%&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/div&gt;`;\n}\n\n\n\n\n\n\n\n\n\n\nyMax = 150\nbaseVal = 50\n\nz_from_x = strength_xz * baseVal\n\ny_direct_x = strength_xy * baseVal\ny_mediated = adjust_z ? 0 : strength_zy * z_from_x\ny_from_z_own = adjust_z ? 0 : strength_zy * baseVal\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// -----------------\n// Interactive DAG\n// -----------------\n{\n  const width = 600;\n  const height = 250;\n  const nodeRadius = 36;\n\n  // Mediator: Z is between X and Y, positioned at top\n  const nodes = {\n    X: { x: 130, y: 200, label: \"X\" },\n    Z: { x: width / 2, y: 60, label: \"Z\" },\n    Y: { x: 470, y: 200, label: \"Y\" }\n  };\n\n  const svg = d3.create(\"svg\")\n    .attr(\"viewBox\", `0 0 ${width} ${height}`)\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .style(\"max-width\", \"100%\");\n\n  const defs = svg.append(\"defs\");\n\n  dag.addArrowMarkers(defs);\n\n  // Mediation hatch: red stripes on gold, slope downward\n  // \"X flowing through Z's territory\"\n  dag.addHatchPattern(\n    defs, \"hatch-mediated\", dag.colorX, dag.colorZ, -45\n  );\n\n  dag.addCircleClip(\n    defs, \"z-clip\", nodes.Z.x, nodes.Z.y, nodeRadius\n  );\n  dag.addCircleClip(\n    defs, \"y-clip\", nodes.Y.x, nodes.Y.y, nodeRadius\n  );\n\n  // Arrows\n  const edges = [\n    {\n      id: \"xz\", from: nodes.X, to: nodes.Z,\n      strength: strength_xz, blocked: false\n    },\n    {\n      id: \"zy\", from: nodes.Z, to: nodes.Y,\n      strength: strength_zy, blocked: adjust_z\n    },\n    {\n      id: \"xy\", from: nodes.X, to: nodes.Y,\n      strength: strength_xy, blocked: false\n    }\n  ];\n\n  for (const edge of edges) {\n    dag.drawEdge(svg, edge, nodeRadius);\n  }\n\n  // Nodes\n  // X is solid\n  dag.drawSolidNode(\n    svg, nodes.X.x, nodes.X.y, nodeRadius, dag.colorX\n  );\n\n  // Z: strength directly controls fill proportion\n  dag.drawNode(svg, nodes.Z.x, nodes.Z.y, nodeRadius, \"z-clip\", {\n    bottomUp: [\n      { prop: strength_xz, fill: dag.colorX }\n    ],\n    topDown: []\n  }, \"horizontal\", dag.colorZ);\n\n  // Y: blue base, incoming effects overlay\n  dag.drawNode(svg, nodes.Y.x, nodes.Y.y, nodeRadius, \"y-clip\", {\n    bottomUp: [\n      { prop: Math.min(y_direct_x / yMax, 1), fill: dag.colorX },\n      {\n        prop: Math.min(y_mediated / yMax, 1),\n        fill: \"url(#hatch-mediated)\"\n      }\n    ],\n    topDown: [\n      {\n        prop: Math.min(y_from_z_own / yMax, 1),\n        fill: dag.colorZ\n      }\n    ]\n  }, undefined, dag.colorY);\n\n  // Labels\n  for (const n of Object.values(nodes)) {\n    dag.drawLabel(svg, n.x, n.y, n.label);\n  }\n\n  return svg.node();\n}"
  },
  {
    "objectID": "confounders.html",
    "href": "confounders.html",
    "title": "Confounders",
    "section": "",
    "text": "d3 = require(\"d3@7\")\ndag = import(new URL(\"js/dag-utils.js\", document.baseURI).href)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelationships between nodes\n\nviewof strength_zx = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; → &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; strength`\n})\n\nviewof strength_zy = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; strength`\n})\n\nviewof strength_xy = Inputs.range([0, 1], {\n  value: 0.7, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; strength`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAdjustments\n\nviewof adjust_z = Inputs.toggle({\n  label: html`&lt;span class=\"node node-z\"&gt;Adjust for Z&lt;/span&gt; (&lt;em&gt;block backdoor path&lt;/em&gt;)`\n})\n\n\n\n\n\n\n\n// ----------------\n// Status readout\n// ----------------\n{\n  const pctPure = Math.round(y_pure_x / yMax * 100);\n  const pctConf = Math.round(y_confounded / yMax * 100);\n  const pctZ = Math.round(y_direct_z / yMax * 100);\n  const pctOwn = Math.max(0, 100 - pctPure - pctConf - pctZ);\n\n  return html`&lt;div class=\"alert alert-secondary status-readout\"&gt;\n    &lt;h5 class=\"alert-heading\"&gt;What Y contains&lt;/h5&gt;\n    &lt;table&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-x\"&gt;X&lt;/span&gt;'s direct influence on &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctPure}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;\n          &lt;defs&gt;\n            &lt;pattern id=\"legend-hatch-conf\" patternUnits=\"userSpaceOnUse\"\n              width=\"6\" height=\"6\" patternTransform=\"rotate(45)\"&gt;\n              &lt;rect width=\"6\" height=\"6\" fill=\"${dag.colorZ}\"/&gt;\n              &lt;line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"6\"\n                stroke=\"${dag.colorX}\" stroke-width=\"2.5\"/&gt;\n            &lt;/pattern&gt;\n          &lt;/defs&gt;\n          &lt;rect width=\"12\" height=\"12\" fill=\"url(#legend-hatch-conf)\"/&gt;\n        &lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;'s influence on &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; via &lt;span class=\"node node-x\"&gt;X&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctConf}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorZ}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;'s direct influence on &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;&lt;/td&gt;\n        &lt;td&gt;${pctZ}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorY}\"/&gt;&lt;/svg&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;span class=\"node node-y\"&gt;Y&lt;/span&gt;'s own variation&lt;/td&gt;\n        &lt;td&gt;${pctOwn}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"summary ${adjust_z ? 'dimmed' : ''}\"&gt;\n        &lt;td&gt;\n          &lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;\n          +\n          &lt;svg width=\"12\" height=\"12\"&gt;\n            &lt;rect width=\"12\" height=\"12\" fill=\"url(#legend-hatch-conf)\"/&gt;\n          &lt;/svg&gt;\n        &lt;/td&gt;\n        &lt;td&gt;Apparent &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; effect&lt;/td&gt;\n        &lt;td&gt;${pctPure + pctConf}%&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"summary ${adjust_z ? '' : 'dimmed'}\"&gt;\n        &lt;td&gt;\n          &lt;svg width=\"12\" height=\"12\"&gt;&lt;rect width=\"12\" height=\"12\" fill=\"${dag.colorX}\"/&gt;&lt;/svg&gt;\n        &lt;/td&gt;\n        &lt;td&gt;Unconfounded &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; effect&lt;/td&gt;\n        &lt;td&gt;${pctPure}%&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/div&gt;`;\n}\n\n\n\n\n\n\n\n\n\n\nyMax = 150\nbaseVal = 50\n\nx_from_z = adjust_z ? 0 : strength_zx * baseVal\n\ny_pure_x = strength_xy * baseVal\ny_confounded = adjust_z ? 0 : strength_xy * x_from_z\ny_direct_z = adjust_z ? 0 : strength_zy * baseVal\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// -----------------\n// Interactive DAG\n// -----------------\n{\n  const width = 600;\n  const height = 250;\n  const nodeRadius = 36;\n\n  const nodes = {\n    Z: { x: width / 2, y: 60, label: \"Z\" },\n    X: { x: 130, y: 200, label: \"X\" },\n    Y: { x: 470, y: 200, label: \"Y\" }\n  };\n\n  const svg = d3.create(\"svg\")\n    .attr(\"viewBox\", `0 0 ${width} ${height}`)\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .style(\"max-width\", \"100%\");\n\n  const defs = svg.append(\"defs\");\n\n  dag.addArrowMarkers(defs);\n  dag.addHatchPattern(\n    defs, \"hatch-confounded\", dag.colorZ, dag.colorX, 45\n  );\n  dag.addCircleClip(\n    defs, \"x-clip\", nodes.X.x, nodes.X.y, nodeRadius\n  );\n  dag.addCircleClip(\n    defs, \"y-clip\", nodes.Y.x, nodes.Y.y, nodeRadius\n  );\n\n  // Arrows\n  const edges = [\n    {\n      id: \"zx\", from: nodes.Z, to: nodes.X,\n      strength: strength_zx, blocked: adjust_z\n    },\n    {\n      id: \"zy\", from: nodes.Z, to: nodes.Y,\n      strength: strength_zy, blocked: adjust_z\n    },\n    {\n      id: \"xy\", from: nodes.X, to: nodes.Y,\n      strength: strength_xy, blocked: false\n    }\n  ];\n\n  for (const edge of edges) {\n    dag.drawEdge(svg, edge, nodeRadius);\n  }\n\n  // Nodes\n  // X: strength directly controls fill proportion\n  dag.drawNode(svg, nodes.X.x, nodes.X.y, nodeRadius, \"x-clip\", {\n    bottomUp: [],\n    topDown: [\n      { prop: strength_zx, fill: dag.colorZ }\n    ]\n  }, undefined, dag.colorX);\n\n  // Y: blue base, incoming effects overlay\n  dag.drawNode(svg, nodes.Y.x, nodes.Y.y, nodeRadius, \"y-clip\", {\n    bottomUp: [\n      { prop: Math.min(y_pure_x / yMax, 1), fill: dag.colorX },\n      {\n        prop: Math.min(y_confounded / yMax, 1),\n        fill: \"url(#hatch-confounded)\"\n      }\n    ],\n    topDown: [\n      { prop: Math.min(y_direct_z / yMax, 1), fill: dag.colorZ }\n    ]\n  }, undefined, dag.colorY);\n\n  dag.drawSolidNode(\n    svg, nodes.Z.x, nodes.Z.y, nodeRadius, dag.colorZ\n  );\n\n  // Labels\n  for (const n of Object.values(nodes)) {\n    dag.drawLabel(svg, n.x, n.y, n.label);\n  }\n\n  return svg.node();\n}"
  },
  {
    "objectID": "colliders.html",
    "href": "colliders.html",
    "title": "Colliders",
    "section": "",
    "text": "d3 = require(\"d3@7\")\njStat = require(\"jstat@1.9.6\")\ndag = import(new URL(\"js/dag-utils.js\", document.baseURI).href)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelationships between nodes\n\nviewof strength_xz = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; strength`\n})\n\nviewof strength_yz = Inputs.range([0, 1], {\n  value: 0.5, \n  step: 0.05, \n  label: html`&lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; → &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt; strength`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelationship between X and Y\n\nviewof xy_exists = Inputs.toggle({\n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; exists (&lt;em&gt;true causal effect&lt;/em&gt;)`\n})\n\nviewof strength_xy = Inputs.range([0, 1], {\n  value: 0.3, \n  step: 0.05,\n  label: html`&lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; strength`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAdjustments\n\nviewof adjust_z = Inputs.toggle({\n  label: html`&lt;span class=\"node node-z\"&gt;Adjust for Z&lt;/span&gt; (&lt;em&gt;or \"condition on\"&lt;/em&gt; &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;)`\n})\n\n\n\n\n\n\n\n// ----------------\n// Status readout\n// ----------------\n{\n  const trueEffect = xy_exists ? strength_xy : 0;\n\n  // Helper functions for formatting true negative signs\n  const fmt_number = (x, d = 3) =&gt;\n    (x &lt; 0 ? \"\\u2212\" : \"\") + Math.abs(x).toFixed(d);\n  const fmt_signed = (x, d = 3) =&gt;\n    (x &gt;= 0 ? \"+\" : \"\\u2212\") + Math.abs(x).toFixed(d);\n  \n  const bias = slope_cond - slope_all;\n\n  return html`&lt;div class=\"alert alert-secondary status-readout\"&gt;\n    &lt;h5 class=\"alert-heading\"&gt;Observed effects&lt;/h5&gt;\n    &lt;table&gt;\n      &lt;tr&gt;\n        &lt;td&gt;True &lt;span class=\"node node-x\"&gt;X&lt;/span&gt; → &lt;span class=\"node node-y\"&gt;Y&lt;/span&gt; effect&lt;/td&gt;\n        &lt;td&gt;${trueEffect === 0 ? \"none\" : fmt_number(trueEffect, 2)}&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;Overall slope&lt;/td&gt;\n        &lt;td&gt;${fmt_number(slope_all)}&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"summary ${adjust_z ? '' : 'dimmed'}\"&gt;\n        &lt;td&gt;Apparent slope (conditioning on &lt;span class=\"node node-z\"&gt;Z&lt;/span&gt;)&lt;/td&gt;\n        &lt;td&gt;${adjust_z ? fmt_number(slope_cond) : \"—\"}&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;N (selected / total)&lt;/td&gt;\n        &lt;td&gt;${adjust_z ? html`${n_selected} / ${simData.length}` : html`${simData.length} / ${simData.length}`}&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"${adjust_z ? '' : 'dimmed'}\"&gt;\n        &lt;td&gt;Bias introduced&lt;/td&gt;\n        &lt;td&gt;${adjust_z\n          ? html`&lt;span class=\"${Math.abs(bias) &gt; 0.05 ? 'text-danger' : ''}\"&gt;${fmt_signed(bias)}&lt;/span&gt;`\n          : \"—\"\n        }&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/div&gt;`;\n}\n\n\n\n\n\n\n\n\n\n\n// Javascript doesn't have native seed functions like set.seed(), so we make one here\n_seed = {\n  // Mulberry32 seeded PRNG\n  function mulberry32(a) {\n    return () =&gt; {\n      a |= 0; a = a + 0x6D2B79F5 | 0;\n      let t = Math.imul(a ^ a &gt;&gt;&gt; 15, 1 | a);\n      t = t + Math.imul(t ^ t &gt;&gt;&gt; 7, 61 | t) ^ t;\n      return ((t ^ t &gt;&gt;&gt; 14) &gt;&gt;&gt; 0) / 4294967296;\n    }\n  }\n\n  const rng = mulberry32(674751);  // From random.org\n  const N = 500;\n  const randn = (sd = 1) =&gt;\n    jStat.normal.inv(rng() * 0.998 + 0.001, 0, sd);\n\n  return {\n    xVals: Array.from({ length: N }, () =&gt; randn()),\n    noiseY: Array.from({ length: N }, () =&gt; randn()),\n    noiseZ: Array.from({ length: N }, () =&gt; randn(0.5))\n  };\n}\n\n\n\n\n\n\n\n// ----------------\n// Simulated data\n// ----------------\n// Z is binary: 1 if the latent combination exceeds 0\nsimData = {\n  const { xVals, noiseY, noiseZ } = _seed;\n  const N = xVals.length;\n  const beta = xy_exists ? strength_xy : 0;\n\n  return xVals.map((x, i) =&gt; {\n    const y = beta * x + noiseY[i];\n    const z_latent = strength_xz * x + strength_yz * y + noiseZ[i];\n    const z = z_latent &gt; 0 ? 1 : 0;\n    return { x, y, z, group: z === 1 ? \"Z = 1\" : \"Z = 0\" };\n  });\n}\n\n\n\n\n\n\n\nz1_points = simData.filter(d =&gt; d.z === 1)\nz0_points = simData.filter(d =&gt; d.z === 0)\nselected = adjust_z ? z1_points : simData\nn_selected = selected.length\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction ols_slope(data) {\n  if (data.length &lt; 3) return 0;\n  const xs = data.map(d =&gt; d.x);\n  const ys = data.map(d =&gt; d.y);\n  const r = jStat.corrcoeff(xs, ys);\n  return r * jStat.stdev(ys, true) / jStat.stdev(xs, true);\n}\n\nslope_all = ols_slope(simData)\nslope_cond = ols_slope(selected)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// -----------------\n// Interactive DAG\n// -----------------\n{\n  const width = 600;\n  const height = 250;\n  const nodeRadius = 36;\n\n  const nodes = {\n    X: { x: 130, y: 200, label: \"X\" },\n    Z: { x: width / 2, y: 60, label: \"Z\" },\n    Y: { x: 470, y: 200, label: \"Y\" }\n  };\n\n  const svg = d3.create(\"svg\")\n    .attr(\"viewBox\", `0 0 ${width} ${height}`)\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .style(\"max-width\", \"100%\");\n\n  const defs = svg.append(\"defs\");\n\n  dag.addArrowMarkers(defs);\n\n  // Arrows\n  const edges = [\n    {\n      id: \"xz\", from: nodes.X, to: nodes.Z,\n      strength: strength_xz, blocked: false\n    },\n    {\n      id: \"yz\", from: nodes.Y, to: nodes.Z,\n      strength: strength_yz, blocked: false\n    }\n  ];\n\n  if (xy_exists) {\n    edges.push({\n      id: \"xy\", from: nodes.X, to: nodes.Y,\n      strength: strength_xy, blocked: false\n    });\n  }\n\n  for (const edge of edges) {\n    dag.drawEdge(svg, edge, nodeRadius);\n  }\n\n  // Add highlighted area behind X and Y when adjusting for Z\n  if (adjust_z) {\n    const padX = 8;\n    const padY = 10;\n    const left = nodes.X.x - nodeRadius - padX;\n    const right = nodes.Y.x + nodeRadius + padX;\n    const top = nodes.X.y - nodeRadius - padY;\n    const h = (nodeRadius + padY) * 2;\n    const w = right - left;\n\n    svg.append(\"rect\")\n      .attr(\"x\", left)\n      .attr(\"y\", top)\n      .attr(\"width\", w)\n      .attr(\"height\", h)\n      .attr(\"rx\", h / 2)\n      .attr(\"ry\", h / 2)\n      .attr(\"fill\", dag.colorZ)\n      .attr(\"opacity\", 0.18);\n  }\n\n  // Nodes\n  dag.drawSolidNode(\n    svg, nodes.X.x, nodes.X.y, nodeRadius, dag.colorX\n  );\n\n  dag.drawSolidNode(\n    svg, nodes.Y.x, nodes.Y.y, nodeRadius, dag.colorY\n  );\n\n  // Z: solid gold, semi-transparent when not conditioning,\n  // fully opaque when conditioning\n  dag.drawSolidNode(\n    svg, nodes.Z.x, nodes.Z.y, nodeRadius, dag.colorZ,\n    adjust_z ? 1 : 0.35\n  );\n\n  // Labels\n  for (const n of Object.values(nodes)) {\n    dag.drawLabel(svg, n.x, n.y, n.label);\n  }\n\n  return svg.node();\n}\n\n\n\n\n\n\n\n// Scatterplot of points with regression line(s)\nPlot.plot({\n  width: 550,\n  height: 340,\n  style: { fontSize: \"12px\" },\n  x: { label: \"X\" },\n  y: { label: \"Y\" },\n  color: {\n    domain: [\"Z = 0\", \"Z = 1\"],\n    range: [dag.colorZ0, dag.colorZ]\n  },\n  marks: [\n    // Faded excluded points (Z = 0 when conditioning)\n    adjust_z\n      ? Plot.dot(z0_points, {\n          x: \"x\", y: \"y\",\n          fill: dag.colorZ0,\n          r: 3,\n          fillOpacity: 0.2\n        })\n      : null,\n\n    // Active points\n    Plot.dot(selected, {\n      x: \"x\", y: \"y\",\n      fill: \"group\",\n      r: 4,\n      fillOpacity: 0.75,\n      stroke: \"#fff\",\n      strokeWidth: 0.5\n    }),\n\n    // Overall regression line\n    Plot.linearRegressionY(simData, {\n      x: \"x\", y: \"y\",\n      stroke: \"#8b8b99\",\n      strokeWidth: 2\n    }),\n\n    // Conditioned regression line\n    adjust_z\n      ? Plot.linearRegressionY(z1_points, {\n          x: \"x\", y: \"y\",\n          stroke: dag.apparentLine,\n          strokeWidth: 2.5,\n          strokeDasharray: \"8 5\"\n        })\n      : null\n  ].filter(Boolean)\n})"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Interactive DAGs",
    "section": "",
    "text": "blah blah blah"
  }
]